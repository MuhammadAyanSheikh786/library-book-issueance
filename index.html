<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FDC Library - Home</title>
  <style>
    :root {
      --bg:#f0f2f5; --text:#111; --card-bg:rgba(255,255,255,0.7); --accent:#6366f1;
    }
    body.dark { --bg:#0f172a; --text:#f8fafc; --card-bg:rgba(30,41,59,0.7); --accent:#22d3ee; }
    body { margin:0; font-family:"Segoe UI",sans-serif; background:var(--bg); color:var(--text); transition:.3s; }

    .navbar { background:var(--accent); color:#fff; display:flex; justify-content:space-between; align-items:center; padding:12px 20px; flex-wrap:wrap; }
    .navbar a { color:#fff; margin:5px 10px; text-decoration:none; font-weight:500; }
    .toggle-btn { background:#fff; color:var(--accent); border:none; padding:6px 12px; border-radius:20px; cursor:pointer; }

    .section { max-width:1100px; margin:30px auto; padding:20px; border-radius:16px; background:var(--card-bg); backdrop-filter:blur(10px); box-shadow:0 4px 16px rgba(0,0,0,0.1); }
    h2 { color:var(--accent); margin-bottom:15px; }

    .dashboard { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:15px; }
    .card { padding:20px; border-radius:14px; text-align:center; background:linear-gradient(135deg,var(--accent),#9333ea); color:#fff; font-weight:600; box-shadow:0 3px 10px rgba(0,0,0,0.2); }

    .form-group { margin-bottom:15px; }
    .form-group label { font-weight:600; display:block; margin-bottom:6px; }
    .form-group input, .form-group select { width:100%; padding:12px; border:1px solid #ccc; border-radius:8px; background:var(--card-bg); color:var(--text); font-size:15px; }

    .btn { padding:12px 18px; border:none; border-radius:10px; cursor:pointer; font-weight:600; font-size:15px; }
    .btn-primary { background:var(--accent); color:#fff; }
    .btn-primary:hover { opacity:0.9; }

    /* Responsive tweaks */
    @media(max-width:600px){ .navbar{flex-direction:column; align-items:flex-start;} }
  </style>
</head>
<body>
  <div class="navbar">
    <div><strong>📖 FDC Library</strong></div>
    <div>
      <a href="index.html">Home</a>
      <a href="records.html">Records</a>
      <a href="login.html">Librarian Login</a>
      <button class="toggle-btn" onclick="toggleMode()">🌙</button>
    </div>
  </div>

  <!-- Dashboard -->
  <div class="section">
    <h2>📊 Dashboard</h2>
    <div class="dashboard">
      <div class="card"><h3>Total Applicants</h3><p id="totalCount">0</p></div>
      <div class="card"><h3>Returned</h3><p id="returnedCount">0</p></div>
      <div class="card"><h3>Pending</h3><p id="pendingCount">0</p></div>
    </div>
  </div>

  <!-- Add Applicant (only librarian can see) -->
  <div class="section" id="addSection" style="display:none;">
    <h2>➕ Add New Applicant</h2>
    <div class="form-group"><label>Student Name</label><input type="text" id="studentName"></div>
    <div class="form-group"><label>Father Name</label><input type="text" id="fatherName"></div>
    <div class="form-group"><label>Roll No</label><input type="text" id="rollNo"></div>
    <div class="form-group"><label>Class</label><select id="studentClass"></select></div>
    <div class="form-group"><label>Book Name</label><input type="text" id="bookName"></div>
    <button class="btn btn-primary" onclick="addApplicant()">Add Applicant</button>
  </div>

<script>
  // 🔹 Every reload → reset login
  localStorage.removeItem("fdcAuth");

  let applicants=JSON.parse(localStorage.getItem("applicants"))||[];
  let isLibrarian=localStorage.getItem("fdcAuth")==="true";

  function save(){ localStorage.setItem("applicants",JSON.stringify(applicants)); }
  function updateDashboard(){
    document.getElementById("totalCount").textContent=applicants.length;
    document.getElementById("returnedCount").textContent=applicants.filter(a=>a.returned).length;
    document.getElementById("pendingCount").textContent=applicants.filter(a=>!a.returned).length;
  }

  function askPin(){ let pin=prompt("Enter Librarian PIN:"); return pin==="@fdc@"; }

  function addApplicant(){
    if(!askPin()){ alert("❌ Wrong PIN"); return; }
    const name=document.getElementById("studentName").value.trim();
    const father=document.getElementById("fatherName").value.trim();
    const roll=document.getElementById("rollNo").value.trim();
    const cls=document.getElementById("studentClass").value;
    const book=document.getElementById("bookName").value.trim();
    if(!name||!father||!roll||!cls||!book){ alert("Fill all fields"); return; }
    applicants.push({id:Date.now(),name,father,roll,class:cls,book,issueDate:new Date().toISOString(),returned:false});
    save(); updateDashboard();
    ["studentName","fatherName","rollNo","studentClass","bookName"].forEach(id=>document.getElementById(id).value="");
    alert("✅ Applicant Added");
  }

  function fillClasses(){
    const sel=document.getElementById("studentClass");
    sel.innerHTML='<option value="">Select Class</option>';
    for(let i=1;i<=12;i++){ sel.innerHTML+=`<option value="${i}">Class ${i}</option>`; }
  }

  function toggleMode(){ document.body.classList.toggle("dark"); localStorage.setItem("theme",document.body.classList.contains("dark")?"dark":"light"); }
  function loadTheme(){ if(localStorage.getItem("theme")==="dark"){ document.body.classList.add("dark"); } }

  // Show Add section only if librarian logged in
  if(isLibrarian){ document.getElementById("addSection").style.display="block"; }

  fillClasses(); loadTheme(); updateDashboard();
</script>
</body>
</html>
